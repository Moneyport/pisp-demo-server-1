@startuml Credential Registration

title: Credential Registration (Part 2)

hide footbox

box "Mobile Device"
  actor Alice
  participant "PISP App" as App
end box
box "PISP"
  participant "PISP Server" as Server
end box
box "Mojaloop"
  participant "Third-party\nAPI Adapter" as Adapter
end box

'start flow

App -> Server ++: ""**PUT /consents/{ID}**""\n\
""{""\n\
""  "requestId": string,""\n\
""  "initiatorId": string,""\n\
""  "participantId": string,""\n\
""  "scopes": [""\n\
""    {""\n\
""      "accountId": string,""\n\
""      "actions": [string]""\n\
""    }""\n\
""  ],""\n\
""  "credential": {""\n\
""    "id": string,""\n\
""    "credentialType": enum, // required?""\n\
""    "status": enum,""\n\
""    "challenge": {""\n\
""      "payload": string,    // base64""\n\
""      "signature": string   // base64""\n\
""    },""\n\
""    "payload": string       // base64""\n\
""  }""\n\
""}""

App <-- Server: ""**HTTP 202** (Accepted)   // not 200?""

deactivate App

Server -> Adapter ++: ""**PUT /consents/{ID}**""\n\
""{""\n\
""  "requestId": string,""\n\
""  "initiatorId": string,""\n\
""  "participantId": string,""\n\
""  "scopes": [""\n\
""    {""\n\
""      "accountId": string,""\n\
""      "actions": [string]""\n\
""    }""\n\
""  ],""\n\
""  "credential": {""\n\
""    "id": string,""\n\
""    "credentialType": enum, // required?""\n\
""    "status": enum,""\n\
""    "challenge": {""\n\
""      "payload": string,    // base64""\n\
""      "signature": string   // base64""\n\
""    },""\n\
""    "payload": string       // base64""\n\
""  }""\n\
""}""

Server <-- Adapter: ""**HTTP 202** (Accepted)   // not 200?""

deactivate Server

Adapter -> Server ++: ""**PUT /consents/{ID}**""\n\
""{""\n\
""  "requestId": string,""\n\
""  "initiatorId": string,""\n\
""  "participantId": string,""\n\
""  "scopes": [""\n\
""    {""\n\
""      "accountId": string,""\n\
""      "actions": [string]""\n\
""    }""\n\
""  ],""\n\
""  "credential": {""\n\
""    "id": string,""\n\
""    "credentialType": enum, // required?""\n\
""    "status": enum,""\n\
""    "challenge": {""\n\
""      "payload": string,    // base64""\n\
""      "signature": string   // base64""\n\
""    },""\n\
""    "payload": string       // base64""\n\
""  }""\n\
""}""

Adapter <-- Server: ""**HTTP 200** (OK)""

@enduml
